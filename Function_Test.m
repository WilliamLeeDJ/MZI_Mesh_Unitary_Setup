clear all;    
APP_TSU4 =...
        [-0.2341+0.0030j -0.1011+0.1765j 0.5216+0.4673j 0.1664+0.6210j;...
         0.0953+0.2949j 0.7782+0.2674j 0.1030+0.3555j -0.2120-0.2120j;...
         0.7987+0.2694j -0.1064+0.2709j -0.1671-0.0954j 0.0357+0.4080j;...
         0.2852+0.2393j -0.3399-0.2852j 0.1006+0.5704j 0.3290-0.4698j];   
% APP_TSU4 = ...
%           [0.4537+0.0634j -0.5334+0.2092j -0.1614-0.3148j -0.3219+0.0813j;...
%            -0.1616+0.4619j 0.177+0.5501j 0.1671+0.0253j 0.0566-0.1039j;...
%            -0.1107-0.1541j -0.0583+0.0828j -0.1295+0.0843j -0.3601-0.4481j;...
%            0.1162-0.2735j -0.0434+0.1023j 0.5294+0.232j -0.0478-0.0316j];
[Phi,Theta] = APP_TSU4_To_Angle_Calculate(APP_TSU4);
[TSU4] = TSU4_Setting_To_APP(Phi,Theta);
TSU4_dagger = transpose(conj(TSU4));
AAA_TSU4 = round(abs(TSU4_dagger*APP_TSU4));
disp(AAA_TSU4);



%  phi = [0.0782 0.1745 0.2618 0.3491 0.4363 0.5236];
%  theta = [1.7453 1.5708 1.3962 1.2217 1.0472 0.8727];




% DMZI_Set1 = DMZI_Setup(theta(1),phi(1));
% DMZI_Set2 = DMZI_Setup(theta(2),phi(2));
% DMZI1_H44 = DMZI_H44_Setup(DMZI_Set1,1);
% DMZI1_H44_dagger = transpose(conj(DMZI1_H44));
% DMZI2_H44 = DMZI_H44_Setup(DMZI_Set2,2);
% DMZI2_H44_dagger = transpose(conj(DMZI2_H44));
% Approach_A = DMZI1_H44*DMZI2_H44;
% Approach_A_dagger = transpose(conj(Approach_A));
% Approach_B_dagger = DMZI2_H44_dagger*DMZI1_H44_dagger;
% 
% disp(Approach_A_dagger);
% disp(Approach_B_dagger);



    function [DMZI_H44] = DMZI_H44_Setup(DMZI_Set_H22,MZI_Top_Channel)
        if MZI_Top_Channel == 1
            DMZI_H44 = [...
                DMZI_Set_H22(1,1) DMZI_Set_H22(1,2) 0 0;...
                DMZI_Set_H22(2,1) DMZI_Set_H22(2,2) 0 0;...
                0                 0                 1 0;...
                0                 0                 0 1];
        end
        if MZI_Top_Channel == 2
             DMZI_H44 = [...
                1 0                 0                 0;...
                0 DMZI_Set_H22(1,1) DMZI_Set_H22(1,2) 0;...
                0 DMZI_Set_H22(2,1) DMZI_Set_H22(2,2) 0;...
                0                 0                 0 1];
        end
        if MZI_Top_Channel == 3
             DMZI_H44 = [...
                1 0 0                 0;...
                0 1 0                 0;...
                0 0 DMZI_Set_H22(1,1) DMZI_Set_H22(1,2);...
                0 0 DMZI_Set_H22(2,1) DMZI_Set_H22(2,2)];
        end       
    end

    function [DMZI_Set] = DMZI_Setup(Theta_Set,Phi_Set)
    DMZI_Set = 1j*exp(1j*Theta_Set/2).*[exp(1j*Phi_Set)*sin(Theta_Set/2) exp(1j*Phi_Set)*cos(Theta_Set/2);...
                                        cos(Theta_Set/2) -1*sin(Theta_Set/2)];
    end